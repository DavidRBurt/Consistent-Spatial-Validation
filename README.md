# Package Installation
Navigate to the `code` directory and run `python setup.py install` in a Python 3.10 environment. The package requires tensorflow (which is quite large), so installation may take some time. Additionally to run the UK housing experiment, we use the package https://github.com/markvdw/RobustGP, which can be installed by running `pip install git+https://github.com/markvdw/RobustGP.git` after installing the other dependencies.

# Running Synthetic Experiments

To recreate the synthetic data experiments in the main text, there is no need to download data (data is generated by scripts included in the repository). The easiest way to regenerate all of the synthetic experiments presented in the main text and appendix is to naviagte to the `code` directory and run `make SyntheticResults` followed by `make SyntheticGridPlots` and `make SyntheticPointPlots`. Plots will be generated in a directory call `figures`. The code defaults to running the experiment on CPU with 10 concurrent threads, although this can be changed by modifiying the bash scripts, which include a `-t NUMBER_OF_THREADS` argument passed to the python scripts used both to generate the synthetic data and to run experiments on the synthetic data. 

# Running the Air Temperature Experiments


## Getting and processing data

Modis data can be downloaded by navigating to 
https://opendap.cr.usgs.gov/opendap/hyrax/DP137/MOLA/MYD11C3.061/2018.01.01/MYD11C3.A2018001.061.2021319132947.hdf.dmr.html and selecting `get as netcdf4`. This requires an EarthData login, which can be registered for here: https://urs.earthdata.nasa.gov/users/new. The resulting file should be placed in the directory `code/spatial_validation/data/AirTemp/AirTempData`.

The GHCNM data is downloaded mostly automatically, but needs to be updated to point to the latest upload of the GHCNM archive, which can be found here: https://www.ncei.noaa.gov/data/global-historical-climatology-network-monthly/v4/temperature/access/. The variable `LATEST` in L16 of `code/spatial_validation/data/airTemp/load_plot_weather_station_data.py` should be of the form `v4.0.1.2024****`, where the stars are replaced by the most recent date data was updated.

Running `make AirTempData` will download and process the data after this. To get data ready for the bootstrapped experiment, you will also need to run `python spatial_validation/data/airTemp/build_synthetic.py`.

## Running the bootstrapped experiment.

The bootstrapped experiment can be run (after data has been processed as above) by runnning `bash experiments/airTempSynthetic/run.sh`. It might be beneficial to change the number of threads depending on resources. As currently setup, it is very memory intensive (about 70GBs of CPU RAM per thread for the grid experiment). 

## Running the real data experiment

First run `mkdir experiments/airTemp/results` then run `make AirTempResults`. To generate the tables run `python experiments/airTemp/plotting/make_table.py`. Currently they are generated transposed relative to the main text.

# Running the UK Housing Prices Experiment

## Getting and processing data

To download the data, run  `python spatial_validation/data/UKHousePrices/download_data.py`. For convenience, we have uploaded a file `combined_ukzip.csv` mapping UK zip codes to latitude, longitude pairs (this can also be generated by). This will need to be decompressed. In `code/spatial_validation/data/UKHousePrices/data` run `tar -xvzf combined_ukzip.tar.gz` and `mv ukzip/combined_ukzip.csv .` to decompress the data and move it into the directory expected in the code.

## Running the experiment

To run the experiment `python experiments/UKHousePrices/UK_housing_experiment.py`. The boxplots in the text and appendix can be generated by running `python experiments/UKHousePrices/plotting/boxplot.py`.

# Running the Wind Speed Experiment

## Getting and processing data

To download the data, run `python spatial_validation/data/windSpeed/download_windSpeed.py`. 

## Running the experiment

To run the experiment `python experiments/windSpeed/windSpeedExperiment.py`. The boxplots in the text and appendix can be generated by running `python experiments/windSpeed/plotting/boxplot.py`.

# Synthetic Model Selection Experiments

To generate the data run `make ModelSelectionDatasets`.

To run the experiments first run `mkdir experiments/model_selection/results` to create a directory the results will be written to, then run `make ModelSelectionResults`.

To generate figures, run `make ModelSelectionPlots`.

